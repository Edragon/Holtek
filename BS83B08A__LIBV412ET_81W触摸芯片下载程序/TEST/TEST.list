				;file F:\ºÏÌ©8Î»»ú\BS83B08A__LIBV412\MAIN_PROGRAM\MAIN_PROGRAM.asm
				;1	        
				;2	message '****************************************************************'
				;3	message '*PROJECT NAME :MAIN PROGRAM                                    *'
				;4	message '*     VERSION :                                                *'
				;5	message '* ICE VERSION :                                                *'
				;6	message '*      REMARK :                                                *'
				;7	message '****************************************************************'
				;8	                ;=INCLUDE REFERENCE FILE                                  '
				;9	                INCLUDE "..\HXT_REFERENCE.INC"
				;10	                INCLUDE MAIN_PROGRAM.INC  
				;11	                PUBLIC  _LOAD_HXT_REFERENCE
				;12	
				;13	                ;==============
				;14	                ;=DATA SETCTION
				;15	                ;==============
				;16	MAIN_DATA       .SECTION          'DATA'
				;17	
				;18	
				;19	
				;20	                ;==============
				;21	                ;=CODE SETCTION
				;22	                ;==============
				;23	PROGRAM_ENTRY   .SECTION  AT 000H 'CODE'
				;24	                JMP     PROGRAM_RESET
				PROGRAM_ENTRY:
				include BS83B08A-3.inc
0000	2818	jmp     PROGRAM_RESET
0001	0000	nop
0002	0000	nop
0003	0000	nop
0004	0000	nop
0005	0000	nop
0006	0000	nop
0007	0000	nop
					----
					----
000A	0000	nop
000B	0000	nop
000C	0000	nop
000D	0000	nop
000E	0000	nop
000F	0000	nop
				;25	
				;26	                ;==============
				;27	                ;=MAIN PROGRAM=
				;28	                ;==============
				;29	MAIN_PROGRAM    .SECTION          'CODE'
				;30	
				;31	                ;;*********************** 
				;32	PROGRAM_RESET:  ;;* PROGRAM ENTRY *******                    
				;33	                ;;*********************** 
				;34	                ;---------------------                                                                                                          
				;35	                ;-MCU HARDWARE INITIAL
				;36	                ;--------------------- 
				;37	
				;38	                IFNDEF  BS83A04A
				;39	                ;-SET SYSTEM CLOCK
				;40	                MOV     A,((SystemClock<<4)^00110000B)&00110000B
				PROGRAM_RESET:
				MAIN_PROGRAM:
0018	0F30	mov     a, 30H
				;41	                MOV     CTRL,A
0019	008C	mov     CTRL, a
				;42	                ENDIF
				;43	
				;44	;                CLR     SMOD1
				;45	                MOV     A,00010011B
001A	0F13	mov     a, 13H
				;46	                MOV     SMOD,A
001B	008B	mov     SMOD, a
				;47	
				;48	                ;-WDT INITIAL USE 125/500MS WHEN ENABLE POWER SAVE MODE                                                                       
				;49	                MOV     A,01010010B     ;125   MS                                                                                             
001C	0F52	mov     a, 52H
				;50	              ;;MOV     A,01010011B     ;500   MS                                                                                             
				;51	                MOV     WDTC,A
001D	009A	mov     WDTC, a
				;52	
				;53	                ;-IF POWER SAVING MODE ENABLE
				;54	                IF      PowerSave==1
				;55	                SZ      TO
				;56	                JMP     WDT_WAKEUP      ;IF WAKEUP BY WDT TIME OUT
				;57	                ENDIF
				;58	
				;59	
				;60	                ;----------------                                                                         
				;61	                ;-CLEAR RAM     -
				;62	                ;----------------
				;63	        IFDEF   BS83A04A
				;64	                ;-CLEAR BANK0 060H~0FFH
				;65	                MOV     A,60H
				;66	                CALL    CLEAR_RAM
				;67	        ENDIF
				;68	        ;-------------------------------
				;69	        IFDEF   BS83B08A
				;70	                ;-CLEAR BANK0 060H~0FFH
				;71	                MOV     A,60H
001E	0F60	mov     a, 60H
				;72	                CALL    CLEAR_RAM
001F	2027	call    CLEAR_RAM
				;73	        ENDIF
				;74	        ;-------------------------------
				;75	        IFDEF   BS83B12A
				;76	                ;-CLEAR BANK1 080H~0FFH
				;77	                MOV     A,1
				;78	                MOV     BP,A
				;79	                MOV     A,80
				;80	                CALL    CLEAR_RAM
				;81	                ;-CLEAR BANK0 060H~0FFH
				;82	                CLR     BP
				;83	                MOV     A,60H
				;84	                CALL    CLEAR_RAM
				;85	        ENDIF
				;86	        ;-------------------------------
				;87	        IFDEF   BS83B16A
				;88	                ;-CLEAR BANK1 080H~0FFH
				;89	                MOV     A,1
				;90	                MOV     BP,A
				;91	                MOV     A,80
				;92	                CALL    CLEAR_RAM
				;93	                ;-CLEAR BANK0 060H~0FFH
				;94	                CLR     BP
				;95	                MOV     A,60H
				;96	                CALL    CLEAR_RAM
				;97	        ENDIF
				;98	        ;-------------------------------
				;99	        IFDEF   BS84B08A
				;100	                ;-DISABLE ADC
				;101	                CLR     ACERL
				;102	                MOV     A,01100000B
				;103	                MOV     ADCR0,A
				;104	                CLR     ADCR1
				;105	                ;-CLEAR BANK1 080H~0FFH
				;106	                MOV     A,1
				;107	                MOV     BP,A
				;108	                MOV     A,80
				;109	                CALL    CLEAR_RAM
				;110	                ;-CLEAR BANK0 060H~0FFH
				;111	                CLR     BP
				;112	                MOV     A,60H
				;113	                CALL    CLEAR_RAM
				;114	        ENDIF
				;115	        ;-------------------------------
				;116	        IFDEF BS84C12A
				;117	                ;-DISABLE ADC
				;118	                CLR     ACERL
				;119	                MOV     A,01100000B
				;120	                MOV     ADCR0,A
				;121	                CLR     ADCR1
				;122	                ;-CLEAR BANK2 280H~2DFH
				;123	                MOV     A,2
				;124	                MOV     BP,A
				;125	                MOV     A,80H
				;126	                CALL    CLEAR_RAM
				;127	                ;-CLEAR BANK1 180H~1FFH
				;128	                MOV     A,1
				;129	                MOV     BP,A
				;130	                MOV     A,80H
				;131	                CALL    CLEAR_RAM
				;132	                ;-CLEAR BANK0 060H~0FFH
				;133	                CLR     BP    
				;134	                MOV     A,60H
				;135	                CALL    CLEAR_RAM
				;136	        ENDIF
				;137	        ;-------------------------------- 
				;138	
				;139	                ;-LOAD LIBRARY OPTION/THRESHOLD                                                                                                 
				;140	                CALL    _LOAD_HXT_REFERENCE
0020	202D	call    _LOAD_HXT_REFERENCE
				;141	
				;142	                ;------------------------
				;143	                ;-EXTEND FUNCTION INITIAL
				;144	                ;------------------------
				;145	                IFDEF   EXTEND_FUNCTION_1A_INITIAL
				;146	                CALL    EXTEND_FUNCTION_1A_INITIAL
0021	214F	call    L014F
				;147	                ENDIF
				;148	                ;--
				;149	                IFDEF   EXTEND_FUNCTION_1B_INITIAL
				;150	                CALL    EXTEND_FUNCTION_1B_INITIAL
0022	2512	call    _USER_PROGRAM_INITIAL
				;151	                ENDIF
				;152	                ;--
				;153	                IFDEF   EXTEND_FUNCTION_1C_INITIAL
				;154	                CALL    EXTEND_FUNCTION_1C_INITIAL
				;155	                ENDIF
				;156	                ;--
				;157	                IFDEF   EXTEND_FUNCTION_1D_INITIAL
				;158	                CALL    EXTEND_FUNCTION_1D_INITIAL
				;159	                ENDIF
				;160	                ;--
				;161	                IFDEF   EXTEND_FUNCTION_1E_INITIAL
				;162	                CALL    EXTEND_FUNCTION_1E_INITIAL
				;163	                ENDIF
				;164	                ;--
				;165	                IFDEF   EXTEND_FUNCTION_1F_INITIAL
				;166	                CALL    EXTEND_FUNCTION_1F_INITIAL
				;167	                ENDIF
				;168	                ;--
				;169	                IFDEF   EXTEND_FUNCTION_1G_INITIAL
				;170	                CALL    EXTEND_FUNCTION_1G_INITIAL
				;171	                ENDIF
				;172	                ;--
				;173	                IFDEF   EXTEND_FUNCTION_1H_INITIAL
				;174	                CALL    EXTEND_FUNCTION_1H_INITIAL
				;175	                ENDIF
				;176	
				;177	
				;178	
				;179	                IFDEF   EXTEND_FUNCTION_2A_INITIAL
				;180	                CALL    EXTEND_FUNCTION_2A_INITIAL
				;181	                ENDIF
				;182	                ;--
				;183	                IFDEF   EXTEND_FUNCTION_2B_INITIAL
				;184	                CALL    EXTEND_FUNCTION_2B_INITIAL
				;185	                ENDIF
				;186	                ;--
				;187	                IFDEF   EXTEND_FUNCTION_2C_INITIAL
				;188	                CALL    EXTEND_FUNCTION_2C_INITIAL
				;189	                ENDIF
				;190	                ;--
				;191	                IFDEF   EXTEND_FUNCTION_2D_INITIAL
				;192	                CALL    EXTEND_FUNCTION_2D_INITIAL
				;193	                ENDIF
				;194	                ;--
				;195	                IFDEF   EXTEND_FUNCTION_2E_INITIAL
				;196	                CALL    EXTEND_FUNCTION_2E_INITIAL
				;197	                ENDIF
				;198	                ;--
				;199	                IFDEF   EXTEND_FUNCTION_2F_INITIAL
				;200	                CALL    EXTEND_FUNCTION_2F_INITIAL
				;201	                ENDIF
				;202	                ;--
				;203	                IFDEF   EXTEND_FUNCTION_2G_INITIAL
				;204	                CALL    EXTEND_FUNCTION_2G_INITIAL
				;205	                ENDIF
				;206	                ;--
				;207	                IFDEF   EXTEND_FUNCTION_2H_INITIAL
				;208	                CALL    EXTEND_FUNCTION_2H_INITIAL
				;209	                ENDIF
				;210	
				;211	
				;212	                ;;-----------------------
				;213	MAIN_LOOP:      ;;- MAIN PROGRAM LOOP ---
				;214	                ;;-----------------------
				;215	                CLR     WDT
				MAIN_LOOP:
0023	0001	clr     wdt
				;216	
				;217	
				;218	                IFDEF   EXTEND_FUNCTION_1A
				;219	                CALL    EXTEND_FUNCTION_1A
0024	2046	call    L0046
				;220	                ENDIF
				;221	                ;--
				;222	                IFDEF   EXTEND_FUNCTION_1B
				;223	                CALL    EXTEND_FUNCTION_1B
0025	2523	call    _USER_PROGRAM
				;224	                ENDIF
				;225	                ;--
				;226	                IFDEF   EXTEND_FUNCTION_1C
				;227	                CALL    EXTEND_FUNCTION_1C
				;228	                ENDIF
				;229	                ;--
				;230	                IFDEF   EXTEND_FUNCTION_1D
				;231	                CALL    EXTEND_FUNCTION_1D
				;232	                ENDIF
				;233	                ;--
				;234	                IFDEF   EXTEND_FUNCTION_1E
				;235	                CALL    EXTEND_FUNCTION_1E
				;236	                ENDIF
				;237	                ;--
				;238	                IFDEF   EXTEND_FUNCTION_1F
				;239	                CALL    EXTEND_FUNCTION_1F
				;240	                ENDIF
				;241	                ;--
				;242	                IFDEF   EXTEND_FUNCTION_1G
				;243	                CALL    EXTEND_FUNCTION_1G
				;244	                ENDIF
				;245	                ;--
				;246	                IFDEF   EXTEND_FUNCTION_1H
				;247	                CALL    EXTEND_FUNCTION_1H
				;248	                ENDIF
				;249	
				;250	
				;251	
				;252	
				;253	                IFDEF   EXTEND_FUNCTION_2A
				;254	                CALL    EXTEND_FUNCTION_2A
				;255	                ENDIF
				;256	                ;--
				;257	                IFDEF   EXTEND_FUNCTION_2B
				;258	                CALL    EXTEND_FUNCTION_2B
				;259	                ENDIF
				;260	                ;--
				;261	                IFDEF   EXTEND_FUNCTION_2C
				;262	                CALL    EXTEND_FUNCTION_2C
				;263	                ENDIF
				;264	                ;--
				;265	                IFDEF   EXTEND_FUNCTION_2D
				;266	                CALL    EXTEND_FUNCTION_2D
				;267	                ENDIF
				;268	                ;--
				;269	                IFDEF   EXTEND_FUNCTION_2E
				;270	                CALL    EXTEND_FUNCTION_2E
				;271	                ENDIF
				;272	                ;--
				;273	                IFDEF   EXTEND_FUNCTION_2F
				;274	                CALL    EXTEND_FUNCTION_2F
				;275	                ENDIF
				;276	                ;--
				;277	                IFDEF   EXTEND_FUNCTION_2G
				;278	                CALL    EXTEND_FUNCTION_2G
				;279	                ENDIF
				;280	                ;--
				;281	                IFDEF   EXTEND_FUNCTION_2H
				;282	                CALL    EXTEND_FUNCTION_2H
				;283	                ENDIF
				;284	
				;285	
				;286	
				;287	                ;--------------------
				;288	WDT_WAKEUP:     ;-WDT WAKEUP FUNCTION
				;289	                ;--------------------
				;290	                IF      PowerSave==1
				;291	                CALL    _CHECK_KEY_WAKEUP
				;292	                ENDIF
				;293	
				;294	                JMP     MAIN_LOOP        
				WDT_WAKEUP:
0026	2823	jmp     MAIN_LOOP
				;295	                
				;296	
				;297	
				;298	
				;299	
				;300	    
				;301	
				;302	
				;303	                                                                                                                                                
				;304	;;***********************************************************                           
				;305	;;*SUB. NAME:                                               *                           
				;306	;;*INPUT    :                                               *                           
				;307	;;*OUTPUT   :                                               *                           
				;308	;;*USED REG.:                                               *                           
				;309	;;*FUNCTION :                                               *                           
				;310	;;***********************************************************
				;311	CLEAR_RAM:
				;312	                MOV     MP1,A
				CLEAR_RAM:
0027	0083	mov     MP1, a
				;313	                CLR     IAR1
0028	1F02	clr     [02H]
				;314	                INCA    MP1
0029	1403	inca    MP1
				;315	                SNZ     Z
002A	390A	snz     Z
				;316	                JMP     $-4
002B	2827	jmp     CLEAR_RAM
				;317	                RET
002C	0003	ret
				;318	
				;319	                                                                                                                                                
				;320	                                                                                                                                                
				;321	                                                                                                                                                
				;322	;;***********************************************************                                                                                   
				;323	;;*SUB. NAME:                                               *                                                                                   
				;324	;;*INPUT    :                                               *                                                                                   
				;325	;;*OUTPUT   :                                               *                                                                                   
				;326	;;*USED REG.:                                               *                                                                                   
				;327	;;*FUNCTION :                                               *                                                                                   
				;328	;;***********************************************************                                                                                   
				;329	_LOAD_HXT_REFERENCE:                                                                                             
				;330	                ;-TKS LIBRARY OPTION                                                                            
				;331	                MOV     A,GlobeOptionA                                                                          
				_LOAD_HXT_REFERENCE:
002D	0F71	mov     a, 71H
				;332	                MOV     _GLOBE_VARIES[0],A                                                                      
002E	00E0	mov     [060H], a
				;333	                MOV     A,GlobeOptionB                                                                          
002F	0FF3	mov     a, F3H
				;334	                MOV     _GLOBE_VARIES[1],A                                                                      
0030	00E1	mov     [061H], a
				;335	                MOV     A,GlobeOptionC                                                                          
0031	0F8C	mov     a, 8CH
				;336	                MOV     _GLOBE_VARIES[2],A  
0032	00E2	mov     [062H], a
				;337	        ;----------------------------------
				;338	        IFDEF   BS83A04A
				;339	                ;-TOUCH OR IO SETTING
				;340	                MOV     A,IO_TOUCH_ATTR&00FH
				;341	                MOV     _KEY_IO_SEL[0],A
				;342	                ;-KEY1 THRESHOLD                                                                                
				;343	                MOV     A,Key1Threshold                                                                         
				;344	                MOV     _GLOBE_VARIES[3],A                                                                      
				;345	                ;-KEY2 THRESHOLD                                                                                
				;346	                MOV     A,Key2Threshold                                                                         
				;347	                MOV     _GLOBE_VARIES[4],A                                                                      
				;348	                ;-KEY3 THRESHOLD                                                                                
				;349	                MOV     A,Key3Threshold                                                                         
				;350	                MOV     _GLOBE_VARIES[5],A                                                                      
				;351	                ;-KEY4 THRESHOLD                                                                                
				;352	                MOV     A,Key4Threshold                                                                         
				;353	                MOV     _GLOBE_VARIES[6],A
				;354	        ENDIF
				;355	        ;----------------------------------
				;356	        IFDEF   BS83B08A 
				;357	                ;-TOUCH OR IO SETTING
				;358	                MOV     A,IO_TOUCH_ATTR&0FFH
0033	0F1F	mov     a, 1FH
				;359	                MOV     _KEY_IO_SEL[0],A
0034	00EC	mov     [06CH], a
				;360	                ;-KEY1 THRESHOLD                                                                                
				;361	                MOV     A,Key1Threshold                                                                         
0035	0F0A	mov     a, AH
				;362	                MOV     _GLOBE_VARIES[3],A                                                                      
0036	00E3	mov     [063H], a
				;363	                ;-KEY2 THRESHOLD                                                                                
				;364	                MOV     A,Key2Threshold                                                                         
0037	0F0A	mov     a, AH
				;365	                MOV     _GLOBE_VARIES[4],A                                                                      
0038	00E4	mov     [064H], a
				;366	                ;-KEY3 THRESHOLD                                                                                
				;367	                MOV     A,Key3Threshold                                                                         
0039	0F0A	mov     a, AH
				;368	                MOV     _GLOBE_VARIES[5],A                                                                      
003A	00E5	mov     [065H], a
				;369	                ;-KEY4 THRESHOLD                                                                                
				;370	                MOV     A,Key4Threshold                                                                         
003B	0F0A	mov     a, AH
				;371	                MOV     _GLOBE_VARIES[6],A  
003C	00E6	mov     [066H], a
				;372	                ;-KEY5 THRESHOLD                                                                                
				;373	                MOV     A,Key5Threshold                                                                         
003D	0F0A	mov     a, AH
				;374	                MOV     _GLOBE_VARIES[7],A                                                                      
003E	00E7	mov     [067H], a
				;375	                ;-KEY6 THRESHOLD                                                                                
				;376	                MOV     A,Key6Threshold                                                                         
003F	0F0A	mov     a, AH
				;377	                MOV     _GLOBE_VARIES[8],A                                                                      
0040	00E8	mov     [068H], a
				;378	                ;-KEY7 THRESHOLD                                                                                
				;379	                MOV     A,Key7Threshold                                                                         
0041	0F0A	mov     a, AH
				;380	                MOV     _GLOBE_VARIES[9],A                                                                      
0042	00E9	mov     [069H], a
				;381	                ;-KEY8 THRESHOLD                                                                                
				;382	                MOV     A,Key8Threshold                                                                         
0043	0F0A	mov     a, AH
				;383	                MOV     _GLOBE_VARIES[10],A
0044	00EA	mov     [06AH], a
				;384	        ENDIF
				;385	        ;----------------------------------
				;386	        IFDEF   BS84B08A
				;387	                ;-TOUCH OR IO SETTING
				;388	                MOV     A,IO_TOUCH_ATTR&0FFH
				;389	                MOV     _KEY_IO_SEL[0],A
				;390	                ;-KEY1 THRESHOLD                                                                                
				;391	                MOV     A,Key1Threshold                                                                         
				;392	                MOV     _GLOBE_VARIES[3],A                                                                      
				;393	                ;-KEY2 THRESHOLD                                                                                
				;394	                MOV     A,Key2Threshold                                                                         
				;395	                MOV     _GLOBE_VARIES[4],A                                                                      
				;396	                ;-KEY3 THRESHOLD                                                                                
				;397	                MOV     A,Key3Threshold                                                                         
				;398	                MOV     _GLOBE_VARIES[5],A                                                                      
				;399	                ;-KEY4 THRESHOLD                                                                                
				;400	                MOV     A,Key4Threshold                                                                         
				;401	                MOV     _GLOBE_VARIES[6],A  
				;402	                ;-KEY5 THRESHOLD                                                                                
				;403	                MOV     A,Key5Threshold                                                                         
				;404	                MOV     _GLOBE_VARIES[7],A                                                                      
				;405	                ;-KEY6 THRESHOLD                                                                                
				;406	                MOV     A,Key6Threshold                                                                         
				;407	                MOV     _GLOBE_VARIES[8],A                                                                      
				;408	                ;-KEY7 THRESHOLD                                                                                
				;409	                MOV     A,Key7Threshold                                                                         
				;410	                MOV     _GLOBE_VARIES[9],A                                                                      
				;411	                ;-KEY8 THRESHOLD                                                                                
				;412	                MOV     A,Key8Threshold                                                                         
				;413	                MOV     _GLOBE_VARIES[10],A
				;414	        ENDIF
				;415	        ;----------------------------------
				;416	        IFDEF   BS83B12A
				;417	                ;-TOUCH OR IO SETTING
				;418	                MOV     A,IO_TOUCH_ATTR&0FFH
				;419	                MOV     _KEY_IO_SEL[0],A
				;420	                MOV     A,(IO_TOUCH_ATTR>>8)&00FH
				;421	                MOV     _KEY_IO_SEL[1],A
				;422	                ;-KEY1 THRESHOLD                                                                                
				;423	                MOV     A,Key1Threshold                                                                         
				;424	                MOV     _GLOBE_VARIES[3],A                                                                      
				;425	                ;-KEY2 THRESHOLD                                                                                
				;426	                MOV     A,Key2Threshold                                                                         
				;427	                MOV     _GLOBE_VARIES[4],A                                                                      
				;428	                ;-KEY3 THRESHOLD                                                                                
				;429	                MOV     A,Key3Threshold                                                                         
				;430	                MOV     _GLOBE_VARIES[5],A                                                                      
				;431	                ;-KEY4 THRESHOLD                                                                                
				;432	                MOV     A,Key4Threshold                                                                         
				;433	                MOV     _GLOBE_VARIES[6],A  
				;434	                ;-KEY5 THRESHOLD                                                                                
				;435	                MOV     A,Key5Threshold                                                                         
				;436	                MOV     _GLOBE_VARIES[7],A                                                                      
				;437	                ;-KEY6 THRESHOLD                                                                                
				;438	                MOV     A,Key6Threshold                                                                         
				;439	                MOV     _GLOBE_VARIES[8],A                                                                      
				;440	                ;-KEY7 THRESHOLD                                                                                
				;441	                MOV     A,Key7Threshold                                                                         
				;442	                MOV     _GLOBE_VARIES[9],A                                                                      
				;443	                ;-KEY8 THRESHOLD                                                                                
				;444	                MOV     A,Key8Threshold                                                                         
				;445	                MOV     _GLOBE_VARIES[10],A
				;446	                ;-KEY9 THRESHOLD                                                                                
				;447	                MOV     A,Key9Threshold                                                                         
				;448	                MOV     _GLOBE_VARIES[11],A
				;449	                ;-KEY10 THRESHOLD                                                                                
				;450	                MOV     A,Key10Threshold                                                                         
				;451	                MOV     _GLOBE_VARIES[12],A
				;452	                ;-KEY11 THRESHOLD                                                                                
				;453	                MOV     A,Key11Threshold                                                                         
				;454	                MOV     _GLOBE_VARIES[13],A
				;455	                ;-KEY12 THRESHOLD                                                                                
				;456	                MOV     A,Key12Threshold                                                                         
				;457	                MOV     _GLOBE_VARIES[14],A
				;458	        ENDIF
				;459	        ;----------------------------------
				;460	        IFDEF   BS84C12A
				;461	                ;-TOUCH OR IO SETTING
				;462	                MOV     A,IO_TOUCH_ATTR&0FFH
				;463	                MOV     _KEY_IO_SEL[0],A
				;464	                MOV     A,(IO_TOUCH_ATTR>>8)&00FH
				;465	                MOV     _KEY_IO_SEL[1],A
				;466	                ;-KEY1 THRESHOLD                                                                                
				;467	                MOV     A,Key1Threshold                                                                         
				;468	                MOV     _GLOBE_VARIES[3],A                                                                      
				;469	                ;-KEY2 THRESHOLD                                                                                
				;470	                MOV     A,Key2Threshold                                                                         
				;471	                MOV     _GLOBE_VARIES[4],A                                                                      
				;472	                ;-KEY3 THRESHOLD                                                                                
				;473	                MOV     A,Key3Threshold                                                                         
				;474	                MOV     _GLOBE_VARIES[5],A                                                                      
				;475	                ;-KEY4 THRESHOLD                                                                                
				;476	                MOV     A,Key4Threshold                                                                         
				;477	                MOV     _GLOBE_VARIES[6],A  
				;478	                ;-KEY5 THRESHOLD                                                                                
				;479	                MOV     A,Key5Threshold                                                                         
				;480	                MOV     _GLOBE_VARIES[7],A                                                                      
				;481	                ;-KEY6 THRESHOLD                                                                                
				;482	                MOV     A,Key6Threshold                                                                         
				;483	                MOV     _GLOBE_VARIES[8],A                                                                      
				;484	                ;-KEY7 THRESHOLD                                                                                
				;485	                MOV     A,Key7Threshold                                                                         
				;486	                MOV     _GLOBE_VARIES[9],A                                                                      
				;487	                ;-KEY8 THRESHOLD                                                                                
				;488	                MOV     A,Key8Threshold                                                                         
				;489	                MOV     _GLOBE_VARIES[10],A
				;490	                ;-KEY9 THRESHOLD                                                                                
				;491	                MOV     A,Key9Threshold                                                                         
				;492	                MOV     _GLOBE_VARIES[11],A
				;493	                ;-KEY10 THRESHOLD                                                                                
				;494	                MOV     A,Key10Threshold                                                                         
				;495	                MOV     _GLOBE_VARIES[12],A
				;496	                ;-KEY11 THRESHOLD                                                                                
				;497	                MOV     A,Key11Threshold                                                                         
				;498	                MOV     _GLOBE_VARIES[13],A
				;499	                ;-KEY12 THRESHOLD                                                                                
				;500	                MOV     A,Key12Threshold                                                                         
				;501	                MOV     _GLOBE_VARIES[14],A
				;502	        ENDIF
				;503	        ;----------------------------------
				;504	        IFDEF   BS83B16A
				;505	
				;506	                ;-TOUCH OR IO SETTING
				;507	                MOV     A,IO_TOUCH_ATTR&0FFH
				;508	                MOV     _KEY_IO_SEL[0],A
				;509	                MOV     A,(IO_TOUCH_ATTR>>8)&0FFH
				;510	                MOV     _KEY_IO_SEL[1],A
				;511	
				;512	                ;-KEY1 THRESHOLD                                                                                
				;513	                MOV     A,Key1Threshold                                                                         
				;514	                MOV     _GLOBE_VARIES[3],A                                                                      
				;515	                ;-KEY2 THRESHOLD                                                                                
				;516	                MOV     A,Key2Threshold                                                                         
				;517	                MOV     _GLOBE_VARIES[4],A                                                                      
				;518	                ;-KEY3 THRESHOLD                                                                                
				;519	                MOV     A,Key3Threshold                                                                         
				;520	                MOV     _GLOBE_VARIES[5],A                                                                      
				;521	                ;-KEY4 THRESHOLD                                                                                
				;522	                MOV     A,Key4Threshold                                                                         
				;523	                MOV     _GLOBE_VARIES[6],A  
				;524	                ;-KEY5 THRESHOLD                                                                                
				;525	                MOV     A,Key5Threshold                                                                         
				;526	                MOV     _GLOBE_VARIES[7],A                                                                      
				;527	                ;-KEY6 THRESHOLD                                                                                
				;528	                MOV     A,Key6Threshold                                                                         
				;529	                MOV     _GLOBE_VARIES[8],A                                                                      
				;530	                ;-KEY7 THRESHOLD                                                                                
				;531	                MOV     A,Key7Threshold                                                                         
				;532	                MOV     _GLOBE_VARIES[9],A                                                                      
				;533	                ;-KEY8 THRESHOLD                                                                                
				;534	                MOV     A,Key8Threshold                                                                         
				;535	                MOV     _GLOBE_VARIES[10],A
				;536	                ;-KEY9 THRESHOLD                                                                                
				;537	                MOV     A,Key9Threshold                                                                         
				;538	                MOV     _GLOBE_VARIES[11],A
				;539	                ;-KEY10 THRESHOLD                                                                                
				;540	                MOV     A,Key10Threshold                                                                         
				;541	                MOV     _GLOBE_VARIES[12],A
				;542	                ;-KEY11 THRESHOLD                                                                                
				;543	                MOV     A,Key11Threshold                                                                         
				;544	                MOV     _GLOBE_VARIES[13],A
				;545	                ;-KEY12 THRESHOLD                                                                                
				;546	                MOV     A,Key12Threshold                                                                         
				;547	                MOV     _GLOBE_VARIES[14],A
				;548	                ;-KEY13 THRESHOLD                                                                                
				;549	                MOV     A,Key13Threshold                                                                         
				;550	                MOV     _GLOBE_VARIES[15],A
				;551	                ;-KEY14 THRESHOLD                                                                                
				;552	                MOV     A,Key14Threshold                                                                         
				;553	                MOV     _GLOBE_VARIES[16],A
				;554	                ;-KEY15 THRESHOLD                                                                                
				;555	                MOV     A,Key15Threshold                                                                         
				;556	                MOV     _GLOBE_VARIES[17],A
				;557	                ;-KEY16 THRESHOLD                                                                                
				;558	                MOV     A,Key16Threshold                                                                         
				;559	                MOV     _GLOBE_VARIES[18],A
				;560	        ENDIF
				;561	                
				;562	                                                                     
				;563	                RET                                                                                             
0045	0003	ret
				L0046:
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
				L014F:
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
				L04C1:
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
				;564	                                                                                                                 
				;565	
				;566	
				;567	                                                      
				;568	                END
				;569	                
				;570	
				;571	
				;file F:\ºÏÌ©8Î»»ú\BS83B08A__LIBV412\USER_PROGRAM\USER_PROGRAM.C
				;1	
				;2	                #include    "..\HXT_REFERENCE.H"
				;3	                #include    "..\MAIN_PROGRAM\MAIN_PROGRAM.H" 
				;4	                  
				;5	   
				;6	
				;7	volatile unsigned	char	_key_val_buf[2];
				;8	//volatile unsigned char  f_125us_flag;
				;9	
				;10	//#pragma vector tmr_isr @0x0c
				;11	//void tmr_isr(void)
				;12	//{
				;13	//	f_125us_flag++;
				;14	//}
				;15	//***********************************************************                           
				;16	//*SUB. NAME: IIC ISR                                       *                           
				;17	//*INPUT    :                                               *                           
				;18	//*OUTPUT   :                                               *                           
				;19	//*USED REG.:                                               *                           
				;20	//*FUNCTION :                                               *                           
				;21	//***********************************************************
				;22	#pragma vector  iic_isr        @ 0x10
				;23	void iic_isr(void)
				;24	{
				@@iic_isr .SECTION 'CODE'
0010	2CEE	jmp     _iic_isr
0011	0000	nop
0012	0000	nop
0013	0000	nop
					----
					----
					----
					----
				_iic_isr:
				@iic_isr .SECTION 'CODE'
04EE	40D8	mov     V4A, a
04EF	070A	mov     a, STATUS
04F0	40D9	mov     V4S, a
				;25		if(_haas)
04F1	3B25	snz     HAAS
04F2	2CFE	jmp     L2
				;26		{										//_haas=1,address match trig interrupt
				;27			if(_srw)
04F3	3925	snz     SRW
04F4	2CF9	jmp     L4
				;28			{									//srw=1:slave in transfer mode	
				;29				_htx = 1;
04F5	3225	set     HTX
				;30				_simd = _key_val_buf[0];	
04F6	4756	mov     a, _key_val_buf[0]
04F7	00A6	mov     SIMD, a
				;31			}
04F8	2D0D	jmp     L3
				;32			else
				;33			{									//srw=0:slave in receive mode
				;34				_htx = 0;
				L4:
04F9	3625	clr     HTX
				;35				_txak = 0;
04FA	35A5	clr     TXAK
				;36				_acc = _simd;					//dummy read from simd to release scl line
04FB	0726	mov     a, SIMD
04FC	0085	mov     ACC, a
				;37			} 
				;38		}
04FD	2D0D	jmp     L3
				;39		else
				;40		{										//_haas=0,data trig interrupt
				;41			if(_htx)
				L2:
04FE	3A25	snz     HTX
04FF	2D0A	jmp     L6
				;42			{									//htx=1:slave in write state;
				;43				if(_rxak)
0500	3825	snz     RXAK
0501	2D07	jmp     L8
				;44				{								//rxak=1:master stop receiving next byte,master releases scl bus
				;45					_htx = 0;
0502	3625	clr     HTX
				;46					_txak = 0;	
0503	35A5	clr     TXAK
				;47					_acc = _simd;				//dummy read from simd to release scl line
0504	0726	mov     a, SIMD
0505	0085	mov     ACC, a
				;48				}
0506	2D0D	jmp     L3
				;49				else
				;50				{								//rxak=0:master wants to receive next byte;	
				;51					_simd = _key_val_buf[1];
				L8:
0507	4757	mov     a, _key_val_buf[1]
0508	00A6	mov     SIMD, a
				;52				}			
				;53			}
0509	2D0D	jmp     L3
				;54			else
				;55			{									//htx=0:slave in read state
				;56				_acc = _simd;
				L6:
050A	0726	mov     a, SIMD
050B	0085	mov     ACC, a
				;57				_txak = 0;	
050C	35A5	clr     TXAK
				;58			}		
				;59		}
				;60		_simf = 0;								//clr i2c interrupt flag 
				L3:
				L7:
050D	360F	clr     SIMF
				L1:
050E	4759	mov     a, V4S
050F	008A	mov     STATUS, a
0510	4758	mov     a, V4A
0511	0004	reti
				;61	}
				;62	
				;63	
				;64	//***********************************************************                           
				;65	//*SUB. NAME:                                               *                           
				;66	//*INPUT    :                                               *                           
				;67	//*OUTPUT   :                                               *                           
				;68	//*USED REG.:                                               *                           
				;69	//*FUNCTION :                                               *                           
				;70	//***********************************************************
				;71	void USER_PROGRAM_INITIAL()
				;72	{
				;73		//IO initial or Varies Initial   
				;74	   //_pdc=0;  
				;75	   _pac1 = 0;  
				_USER_PROGRAM_INITIAL:
				@USER_PROGRAM_INITIAL .SECTION 'CODE'
0512	3495	clr     PAC1
				;76	   _papu1 = 0;
0513	3496	clr     PAPU1
				;77	   _pa1 = 0;
0514	3494	clr     PA1
				;78	   //_pec=0;    
				;79	   //_pfc=0;       
				;80		_pac0=1;
0515	3015	set     PAC0
				;81		_pac2=1;
0516	3115	set     PAC2
				;82		_papu0 = 0;
0517	3416	clr     PAPU0
				;83		_papu2 = 0;
0518	3516	clr     PAPU2
				;84		_simc0=0b11000010;
0519	0FC2	mov     a, C2H
051A	00A4	mov     SIMC0, a
				;85		_sima =0b01110100;
051B	0F74	mov     a, 74H
051C	00A7	mov     SIMC2, a
				;86		_i2ctoen=0;
051D	37A3	clr     I2CTOEN
				;87		
				;88		_simf=0;
051E	360F	clr     SIMF
				;89		_sime=1;
051F	300F	set     SIME
				;90		_key_val_buf[0]=0x00;
0520	5F56	clr     _key_val_buf[0]
				;91		_key_val_buf[1]=0x00;
0521	5F57	clr     _key_val_buf[1]
				L11:
0522	0003	ret
				;92		/*tmr init*/
				;93	//	_tmr = 255-124;
				;94	//	_tmrc = 0b00010011;
				;95	//	_te = 1;
				;96	}
				;97	
				;98	
				;99	
				;100	//***********************************************************                           
				;101	//*SUB. NAME:                                               *                           
				;102	//*INPUT    :                                               *                           
				;103	//*OUTPUT   :                                               *                           
				;104	//*USED REG.:                                               *                           
				;105	//*FUNCTION :                                               *                           
				;106	//***********************************************************
				;107	void USER_PROGRAM()
				;108	{
				;109	 	GET_KEY_BITMAP();	 
				_USER_PROGRAM:
				@USER_PROGRAM .SECTION 'CODE'
0523	24C1	call    L04C1
				;110	  	// get key
				;111	  	_key_val_buf[0] = DATA_BUF[0];
0524	0F00	mov     a, 0H
0525	0084	mov     BP, a
0526	0F7E	mov     a, 7EH
0527	0083	mov     MP1, a
0528	0702	mov     a, [02H]
0529	40D6	mov     _key_val_buf[0], a
				;112	  	_key_val_buf[1]=~_key_val_buf[0];
052A	4156	cpla    _key_val_buf[0]
052B	40D7	mov     _key_val_buf[1], a
				;113	  	if(_key_val_buf[0] == 0x01)
052C	4756	mov     a, _key_val_buf[0]
052D	0C01	xor     a, 1H
052E	390A	snz     Z
052F	2D32	jmp     L15
				;114	  	{
				;115	  		_pa1 = 1;
0530	3094	set     PA1
				;116	  	}
0531	2D33	jmp     L13
				;117	  	else
				;118	  	{
				;119	  		_pa1 = 0;
				L15:
0532	3494	clr     PA1
				L13:
				L16:
0533	0003	ret
				;120	  	}
				;121	}
				;122	
				;123	
				;124	
				;125	
				;126	
				data .SECTION 'DATA'
				_key_val_buf DB DUP (?) ; _key_val_buf
				V4A DB DUP (?)
				V4S DB DUP (?)
